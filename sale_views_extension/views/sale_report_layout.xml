<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <template id="external_layout_sale" inherit_id="web.external_layout_background" primary="True">
    <xpath expr="//img" position="after">
      <div class="float-right">
        <h3 class="text-right text-nowrap">
          <t t-if="not (env.context.get('proforma', False) or is_pro_forma)">
            <span t-if="doc.state not in ['draft','sent']">SALES ORDER<br/></span>
            <span t-if="doc.state in ['draft','sent']">QUOTATION<br/></span>
          </t>
          <t t-if="env.context.get('proforma', False) or is_pro_forma">
            <span class="text-right">PRO-FORMA INVOICE<br/></span>
          </t>
        </h3>
        <h3>
          <span class="float-right text-muted" t-field="doc.name"/>
        </h3>
      </div>
    </xpath>
    <xpath expr="//div[hasclass('footer')]/div/div[last()]" position="after">
      <div class="float-left text-muted" style="font-size: 8px;">
        <t t-if="doc.state in ['draft','sent']"><small>REPORT-S1 (v.230915)</small></t>
        <t t-if="doc.state not in ['draft','sent']"><small>REPORT-S2 (v.230915)</small></t>
        <t t-if="env.context.get('proforma', False) or is_pro_forma"><small>REPORT-S3 (v.230915)</small></t>
      </div>
    </xpath>
  </template>
  <template id="external_layout">
    <t t-if="not o" t-set="o" t-value="doc"/>
    <t t-if="not company">
      <!-- Multicompany -->
      <t t-if="company_id">
        <t t-set="company" t-value="company_id"/>
      </t>
      <t t-elif="o and 'company_id' in o">
        <t t-set="company" t-value="o.company_id.sudo()"/>
      </t>
      <t t-else="else">
        <t t-set="company" t-value="res_company"/>
      </t>
    </t>
    <t t-call="sale_views_extension.external_layout_sale"><t t-raw="0"/></t>
  </template>
</odoo>
